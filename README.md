# CANlearn Pro - 专业级CAN总线分析工具

CANlearn Pro 是一款基于C# WPF开发的现代化、高性能CAN总线分析软件。专为汽车电子工程师和嵌入式开发者设计，提供从数据捕获、协议解析到回放测试的全套解决方案。

## 🌟 核心功能

### 1. 强大的硬件支持
- **设备支持**: 完美兼容 USB2XXX 系列 (USB2CAN) 转换器。
- **双通道并发**: 支持 CAN 1 / CAN 2 双通道同时接收与发送。
- **CAN FD 支持**: 全面支持 CAN FD 协议，数据域波特率最高支持 8Mbps。
- **多种波特率**: 标称波特率支持 125k - 1000k，自定义波特率配置。

### 2. 智能嗅探器 (Sniffer)
- **实时流量分析**: 自动统计帧ID、频率、周期（最大/最小/平均）。
- **差异检查模式 (Check Mode)**: 
  - 自动建立基线（Baseline）。
  -此处高亮显示与基线不一致的数据字节（红色高亮）。
  - 支持"合并检查"（Merge），将新的稳定数据更新为基线。
  - **新功能**: 自动识别并显示合并后新出现的ID及其真实长度。
- **位矩阵 (Bit Matrix)**: 64位数据位的热力图显示，直观观察信号跳变位。
- **智能过滤**: 支持ID和数据内容的实时过滤。

### 3. DBC 协议解析
- **DBC加载**: 支持加载标准 `.dbc` 数据库文件。
- **信号解码**: 在嗅探器中实时解析并显示物理值（信号名: 数值 单位）。
- **多路复用**: 支持Intel/Motorola格式解码。

### 4. 高性能日志记录
- **二进制存储**: 采用高效的二进制格式记录海量数据，占用空间小，读写速度快。
- **虚拟列表技术**: UI采用虚拟化渲染，轻松流畅显示百万级数据帧，无卡顿。
- **高级过滤**: 支持在日志回放时进行ID筛选。
- **导出功能**: 支持导出为文本或其他格式。

### 5. 数据回放 (Replay)
- **精准回放**: 将历史记录的CAN报文按时间戳重新发送到总线。
- **循环发送**: 支持单次或循环回放，模拟真实ECU行为。

### 6. 诊断与监控
- **信号监控**: 实时波形图显示指定信号的变化趋势。
- **UDS/ISO-TP**: 内置ISO-TP协议栈，支持多帧报文的自动重组与发送（15765-2）。
- **仪表盘**: 可视化仪表盘展示关键车辆参数。

## 🛠️ 技术特性
- **架构**: 基于 .NET 8.0 + WPF，采用 MVVM 设计模式，结构清晰，易于扩展。
- **性能优化**: 
  - UI渲染优化：采用"脏标记"（Dirty Flag）机制，仅刷新变化的数据行，大幅降低CPU占用。
  - **并发模型**: 采用 **生产者-消费者 (Producer-Consumer)** 模式，基于 `System.Threading.Channels` 实现 USB 接收与 UI 渲染的无锁解耦，轻松应付满负载总线流量。
  - 内存管理：优化的数据结构，避免大量GC压力。
- **国际化**: 原生支持 中文/英文 双语切换。

## 📦 环境要求
- **操作系统**: Windows 10 / 11 (64-bit)
- **运行环境**: .NET 8.0 Runtime
- **驱动程序**: 需要安装 USB2XXX 驱动及 `libusb-1.0.dll`

## 🚀 快速开始

1. **连接设备**: 插入 USB2CAN 适配器。
2. **启动软件**: 运行 `CANlearnWPF.exe`。
3. **配置连接**: 
   - 在左侧侧边栏点击 "扫描设备"。
   - 选择通道与波特率（如 500k / 2M）。
   - 点击 "连接"。
4. **开始分析**: 点击工具栏的 "开始嗅探" 即可看到总线数据。

## 🔧 开发路线图 (Roadmap)
- [x] CAN FD 完整支持
- [x] 差异检查模式优化（新ID显示修复）
- [x] 软件重启功能
- [x] DBC 基础解析
- [ ] 脚本引擎 (Scripting Engine) 支持
- [ ] 增强的图表分析功能
- [ ] 数据导出 Excel/Matlab 格式
- [ ] UDS 诊断服务完全实现

## 📄 版权说明
Copyright © 2024 James. All rights reserved.
本项目仅供学习研究及商业评估使用。
